#!/usr/bin/env python
# -*- coding: utf-8 -*-

import sys
import ConfigParser
from infrasim import ipmi


if __name__ == '__main__':
    config = ConfigParser.ConfigParser()
    config.read('/etc/infrasim/infrasim.conf')
    node = config.get('main', 'node')
    if sys.argv[1] == "start":
        ipmi.ipmi_start(node)
    elif sys.argv[1] == "stop":
        ipmi.ipmi_stop()
    elif sys.argv[1] == "status":
        ipmi.ipmi_status()
    elif sys.argv[1] == "restart":
        ipmi.ipmi_stop()
        print "Restart InfraSIM service..."
        ipmi.ipmi_start(node)
    else:
        ipmi.ipmi_help()
